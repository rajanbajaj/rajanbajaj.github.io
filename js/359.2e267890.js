"use strict";(self["webpackChunklearnwithme_app"]=self["webpackChunklearnwithme_app"]||[]).push([[359],{7359:(t,e,s)=>{s.r(e),s.d(e,{default:()=>v});var o=s(3673),r=s(2323);const a={key:2,class:"q-pa-md row items-start q-gutter-md"},i={class:"q-pa-lg flex flex-center"};function n(t,e,s,n,l,c){const h=(0,o.up)("q-btn"),u=(0,o.up)("q-banner"),d=(0,o.up)("q-circular-progress"),k=(0,o.up)("PostShortComponent"),m=(0,o.up)("q-pagination"),p=(0,o.up)("q-page");return(0,o.wg)(),(0,o.j4)(p,null,{default:(0,o.w5)((()=>[t.isError?((0,o.wg)(),(0,o.j4)(u,{key:0,dense:"",class:"bg-red text-white"},{action:(0,o.w5)((()=>[(0,o.Wm)(h,{flat:"",color:"white",label:"Dismiss",onClick:t.dismiss},null,8,["onClick"])])),default:(0,o.w5)((()=>[(0,o.Uk)((0,r.zw)(t.error)+" ",1)])),_:1})):(0,o.kq)("",!0),t.isLoading?((0,o.wg)(),(0,o.j4)(d,{key:1,indeterminate:"",size:"90px",thickness:.2,color:"lime","center-color":"grey-8","track-color":"transparent",class:"q-ma-xl"},null,8,["thickness"])):((0,o.wg)(),(0,o.iD)("div",a,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.posts,(t=>((0,o.wg)(),(0,o.j4)(k,{post:t,key:t._id,class:"col-5"},null,8,["post"])))),128))])),(0,o._)("div",null,[(0,o._)("div",i,[(0,o.Wm)(m,{modelValue:t.currentPage,"onUpdate:modelValue":e[0]||(e[0]=e=>t.currentPage=e),color:"purple",max:t.max,"max-pages":t.maxPages,"boundary-numbers":""},null,8,["modelValue","max","max-pages"])])])])),_:1})}const l={class:"text-h6"},c=(0,o.Uk)(" BY "),h={class:"text-subtitle2"},u=["innerHTML"];function d(t,e,s,a,i,n){const d=(0,o.up)("q-card-section"),k=(0,o.up)("q-separator"),m=(0,o.up)("q-badge"),p=(0,o.up)("q-btn"),g=(0,o.up)("q-card-actions"),f=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(f,{class:"my-card q-ma-md q-pa-md"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[(0,o._)("div",l,(0,r.zw)(t.post.title),1),c,(0,o._)("div",h,(0,r.zw)(t.post.author),1)])),_:1}),t.post.summary?((0,o.wg)(),(0,o.j4)(k,{key:0})):(0,o.kq)("",!0),t.post.summary?((0,o.wg)(),(0,o.j4)(d,{key:1,class:"q-pt-none"},{default:(0,o.w5)((()=>[(0,o._)("div",{innerHTML:t.post.summary},null,8,u)])),_:1})):(0,o.kq)("",!0),(0,o.Wm)(k),(0,o.Wm)(d,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(t.post.tags,(t=>((0,o.wg)(),(0,o.j4)(m,{key:t,outline:"",color:"secondary",label:t},null,8,["label"])))),128))])),_:1}),(0,o.Wm)(k),(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Wm)(p,{flat:"",round:"",color:t.likeColor,onClick:e[0]||(e[0]=e=>t.like(t.post._id)),icon:"favorite"},null,8,["color"]),(0,o.Wm)(p,{flat:"",round:"",color:t.bookmarkColor,onClick:e[1]||(e[1]=e=>t.bookmark(t.post._id)),icon:"bookmark"},null,8,["color"]),(0,o.Wm)(p,{flat:"",round:"",hint:"share",onClick:e[2]||(e[2]=e=>t.share(t.post._id)),icon:"share"}),(0,o.Wm)(p,{flat:"",round:"",onClick:e[3]||(e[3]=e=>t.deletePost(t.post._id)),icon:"delete"}),(0,o.Wm)(p,{type:"a",href:`/#posts/${t.post._id}`,flat:"",icon:"play_lesson"},null,8,["href"]),(0,o.Wm)(p,{type:"a",href:`/#posts/edit/${t.post._id}`,flat:"",icon:"edit"},null,8,["href"])])),_:1})])),_:1})}var k=s(2471),m=s(4434),p=s(52),g=s.n(p);const f=(0,o.aZ)({name:"PostShortComponent",props:{post:{type:Object,required:!0},icon:{type:String,default:"article"}},data(){return{likeColor:"default",bookmarkColor:"default",shareColor:"secondary",fetch_url:`https://learndottogether.herokuapp.com/api/posts/${this.post._id}`,config:{headers:{Authorization:`Bearer ${k.Z.get("access_token")}`}},currentUserId:"",likes:0,bookmarks:0,isLikedByCurrentUser:0,isBookmarkedByCurrentUser:0}},mounted(){this.currentUserId=this.parseJwt(k.Z.get("access_token")).id,g().get(`${this.fetch_url}/likes/count`,this.config).then((t=>{this.likes=t.data})).catch((t=>console.log(t))),g().get(`${this.fetch_url}/likes/${this.currentUserId}/count`,this.config).then((t=>{this.isLikedByCurrentUser=t.data,this.isLikedByCurrentUser&&(this.likeColor="red")})).catch((t=>console.log(t))),g().get(`${this.fetch_url}/bookmarks/count`,this.config).then((t=>{this.bookmarks=t.data})).catch((t=>console.log(t))),g().get(`${this.fetch_url}/bookmarks/${this.currentUserId}/count`,this.config).then((t=>{this.isBookmarkedByCurrentUser=t.data,this.isBookmarkedByCurrentUser&&(this.bookmarkColor="accent")})).catch((t=>console.log(t)))},methods:{like(t){"default"===this.likeColor?this.likeColor="red":this.likeColor="default",g().post(`${this.fetch_url}/likes/${this.currentUserId}`,{data:""},this.config).then((t=>{g().get(`${this.fetch_url}/likes/${this.currentUserId}/count`,this.config).then((t=>{this.isLikedByCurrentUser=t.data,this.isLikedByCurrentUser&&(this.likeColor="red")})).catch((t=>console.log(t)))})).catch((t=>console.log(t)))},bookmark(t){"default"===this.bookmarkColor?this.bookmarkColor="accent":this.bookmarkColor="default",g().post(`${this.fetch_url}/bookmarks/${this.currentUserId}`,{data:""},this.config).then((t=>{g().get(`${this.fetch_url}/bookmarks/${this.currentUserId}/count`,this.config).then((t=>{this.isBookmarkedByCurrentUser=t.data,this.isBookmarkedByCurrentUser&&(this.bookmarkColor="accent")})).catch((t=>console.log(t)))})).catch((t=>console.log(t)))},share(t){},deletePost(t){g()["delete"](this.fetch_url,this.config).then((t=>{m.Z.create({message:"Successfully Deleted",color:"green"})})).catch((t=>{m.Z.create({message:t.message,color:"red"})}))},parseJwt(t){if(!t)return;const e=t.split(".")[1],s=e.replace("-","+").replace("_","/");return JSON.parse(window.atob(s))}}});var _=s(151),C=s(5589),w=s(5869),y=s(9721),b=s(9367),B=s(2165),q=s(7518),U=s.n(q);f.render=d;const $=f;U()(f,"components",{QCard:_.Z,QCardSection:C.Z,QSeparator:w.Z,QBadge:y.Z,QCardActions:b.Z,QBtn:B.Z});const P=(0,o.aZ)({name:"Posts",components:{PostShortComponent:$},data:function(){let t=[];return{posts:t,isLoading:!0,fetch_url:"https://learndottogether.herokuapp.com/api/posts?status=PUBLIC&limit=4",fetch_count_url:"https://learndottogether.herokuapp.com/api/posts/count?status=PUBLIC",config:{headers:{Authorization:`Bearer ${k.Z.get("access_token")}`}},isError:!1,error:"",currentPage:1,max:0,maxPages:0}},created(){let t=this.$route.query.keyword;t&&(this.fetch_url=this.fetch_url+`&keyword=${t}`,this.fetch_count_url=this.fetch_count_url+`&keyword=${t}`),this.getData(),this.getCount()},watch:{currentPage:function(){this.getData()}},methods:{getData(){g().get(this.fetch_url+"&start="+4*(this.currentPage-1),this.config).then((t=>{let e=t.data.results;this.posts=e,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.isError=!0,this.error=t.message}))},getCount(){g().get(this.fetch_count_url,this.config).then((t=>{let e=t.data;this.max=e%4?e/4+1:e/4,this.maxPages=e/8+1,this.isLoading=!1})).catch((t=>{this.isLoading=!1,this.isError=!0,this.error=t.message}))},dismiss(){this.error="",this.isError=!1}}});var Z=s(4379),x=s(5607),L=s(6122),W=s(7300);P.render=n;const v=P;U()(P,"components",{QPage:Z.Z,QBanner:x.Z,QBtn:B.Z,QCircularProgress:L.Z,QPagination:W.Z})}}]);